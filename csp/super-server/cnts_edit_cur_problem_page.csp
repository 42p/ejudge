<% /* -*- html -*- */
%><%@include "includes.csp"
%><%
#include "ejudge/meta/prepare_meta.h"
%><%@set getter_name = "csp_get_cnts_edit_cur_problem_page"
%><%@set ac_prefix = "SSERV_CMD_"
%><%@set err_prefix = "SSERV_ERR_"
%><%@page csp_view_cnts_edit_cur_problem_page(PageInterface *pg, FILE *log_f, FILE *out_f, struct http_request_info *phr)
%><%@include "stdvars.csp"
%><%
    unsigned char subtitle_buf[1024];
    const unsigned char *title = 0;
    const unsigned char *subtitle = subtitle_buf;
    opcap_t caps = 0;
    int row = 1;
    int cur_page = 4;
    int i;
    int prob_id = 0;
    const struct section_problem_data *prob = NULL;
    struct section_problem_data *tmp_prob = NULL;
    const struct section_problem_data *sup_prob = 0;
    int sup_id = 0, prob_type = 0;
    const unsigned char *str_value = NULL;
    int value;
    unsigned char num_buf[128];

static const unsigned char head_row_attr[] =
  " bgcolor=\"#a0a0a0\"";
static const unsigned char * const form_row_attrs[]=
{
  " bgcolor=\"#d0d0d0\"",
  " bgcolor=\"#e0e0e0\"",
};

    if (phr->priv_level != PRIV_LEVEL_ADMIN) FAIL(SSERV_ERR_PERMISSION_DENIED);
    if (ejudge_cfg_opcaps_find(phr->config, phr->login, &caps) < 0) FAIL(SSERV_ERR_PERMISSION_DENIED);
    if (opcaps_check(caps, OPCAP_EDIT_CONTEST) < 0) FAIL(SSERV_ERR_PERMISSION_DENIED);
    if (!phr->ss->edited_cnts) FAIL(SSERV_ERR_CONTEST_NOT_EDITED);

%><s:read var="prob_id" required="yes" /><%

    if (prob_id <= 0) {
        i = -prob_id;
        if (i >= phr->ss->aprob_u) FAIL(SSERV_ERR_INVALID_PARAMETER);
        prob = phr->ss->aprobs[i];
        if (!prob) FAIL(SSERV_ERR_INVALID_PARAMETER);
        snprintf(subtitle_buf, sizeof(subtitle_buf), "editing serve.cfg, problem %s", prob->short_name);
    } else {
        i = prob_id;
        if (i >= phr->ss->prob_a) FAIL(SSERV_ERR_INVALID_PARAMETER);
        prob = phr->ss->probs[i];
        if (!prob) FAIL(SSERV_ERR_INVALID_PARAMETER);
        snprintf(subtitle_buf, sizeof(subtitle_buf), "editing serve.cfg, problem %d", i);

        int j;
        if (prob->super && prob->super[0]) {
            for (j = 0; j < phr->ss->aprob_u; ++j) {
                if (!strcmp(prob->super, phr->ss->aprobs[j]->short_name)) {
                    sup_prob = phr->ss->aprobs[j];
                    sup_id = j + 1;
                    break;
                }
            }
        }
    }
    tmp_prob = prepare_copy_problem(prob);

    cnts = phr->ss->edited_cnts;
    struct section_global_data *global = phr->ss->global;

    prepare_set_all_prob_values(tmp_prob, sup_prob, global);

    (void) row;
    (void) head_row_attr;
    (void) form_row_attrs;

    (void) sup_id;
    (void) sup_prob;
%><%@include "header_jqgrid.csp"
%>
<script src='<s:config name="style-prefix" />priv_prob_dlg.js' type="text/javascript"></script>

<%@include "cnts_edit_cur_top_menu.csp"
%>

<%
  if (phr->ss->serve_parse_errors) {
%>
<h2><tt>serve.cfg</tt> cannot be edited</h2>
<font color="red"><pre><s:v value="phr->ss->serve_parse_errors" /></pre></font>
<%
    goto bottom_links;
  }
%>

<%
  if (!global) {
%>
<h2>No current global settings!</h2>
<%
    goto bottom_links;
  }
%>

<div id="IdDialogDiv" title="Problem Identification">
    <s:form id="IdDialogForm">
        <s:hidden name="action" ac="glob-save-main-form" />
        <input type="hidden" id="IdDialogProbId" name="prob_id" value="" />

        <div>
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-prob_id_xxx">ID:</label></div>
            <input readonly="readonly" type="text" size="20" name="prob_id_xxx" id="edit-prob_id" value="" class="text ui-widget-content ui-corner-all" />
        </div>

        <div id="edit-short_name-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-short_name">Short name:</label></div>
            <input type="text" size="20" name="short_name" id="edit-short_name" value="" class="text ui-widget-content ui-corner-all" />
        </div>

        <div id="edit-internal_name-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-internal_name">Internal name:</label></div>
            <input type="text" size="20" name="internal_name" id="edit-internal_name" value="" class="text ui-widget-content ui-corner-all" />
        </div>

        <div id="edit-long_name-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-long_name">Long name:</label></div>
            <input type="text" size="20" name="long_name" id="edit-long_name" value="" class="text ui-widget-content ui-corner-all" />
        </div>

        <div id="edit-super-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-super">Base abstract problem:</label></div>
            <select id="edit-super" name="super">
                <option></option>
<%
  for (i = 0; i < phr->ss->aprob_u; ++i) {
%><option><s:v value="phr->ss->aprobs[i]->short_name" /></option>
<%
  }
%>
            </select>
        </div>

        <div id="edit-type-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-type">Type:</label></div>
            <select id="edit-type" name="type">
                <option>standard</option>
                <option>output-only</option>
                <option>short-answer</option>
                <option>text-answer</option>
                <option>select-one</option>
                <option>select-many</option>
                <option>custom</option>
                <option>tests</option>
            </select>
        </div>

        <div id="edit-variant_num-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-variant_num">Number of variants:</label></div>
            <input type="text" size="20" name="variant_num" id="edit-variant_num" value="" class="text ui-widget-content ui-corner-all" onchange="idDialogOnChange()" />
        </div>

        <div id="edit-autoassign_variants-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-autoassign_variants">Assign variants automatically?</label></div>
            <select id="edit-autoassign_variants" name="autoassign_variants">
<%
  if (sup_prob) {
%>
                <option value="-1">Default</option>
<%
  }
%>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>

    </s:form>
</div>

<div id="FilesDialogDiv" title="Files and directories">
    <s:form id="FilesDialogForm">
        <s:hidden name="action" ac="glob-save-main-form" />
        <input type="hidden" id="FilesDialogProbId" name="prob_id" value="" />

        <div id="edit-binary_input-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-binary_input">Input data is binary?</label></div>
            <select id="edit-binary_input" name="binary_input" onchange="filesDialogOnChange()">
<%
  if (sup_prob) {
%>
                <option value="-1">Default</option>
<%
  }
%>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>

        <div id="edit-normalization-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-normalization">Test normalization mode:</label></div>
            <select id="edit-normalization" name="normalization">
                <option value="0">none - No normalization</option>
<%
  if (sup_prob) {
%>
                <option value="1">Default</option>
<%
  }
%>
                <option value="2">nl - End-of-line</option>
                <option value="3">nlws - End-of-line and trailing space</option>
                <option value="4">nlwsnp - End-of-line, trailing space and lines</option>
                <option value="5">nlnp - End-of-line and trailing lines</option>
            </select>
        </div>

        <div id="edit-xml_file-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-xml_file">XML File with problem statement:</label></div>
            <input type="text" size="20" name="xml_file" id="edit-xml_file" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('xml_file')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="xml_file-dflt" id="edit-xml_file-dflt" value="1" onchange="filesDialogOnChange('xml_file-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-test_dir-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-test_dir">Directory with tests:</label></div>
            <input type="text" size="20" name="test_dir" id="edit-test_dir" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('test_dir')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="test_dir-dflt" id="edit-test_dir-dflt" value="1" onchange="filesDialogOnChange('test_dir-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-test_pat-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-test_pat">Pattern for test file names:</label></div>
            <input type="text" size="20" name="test_pat" id="edit-test_pat" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('test_pat')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="test_pat-dflt" id="edit-test_pat-dflt" value="1" onchange="filesDialogOnChange('test_pat-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-test_sfx-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-test_sfx">Suffix of test files:</label></div>
            <input type="text" size="20" name="test_sfx" id="edit-test_sfx" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('test_sfx')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="test_sfx-dflt" id="edit-test_sfx-dflt" value="1" onchange="filesDialogOnChange('test_sfx-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-use_corr-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-use_corr">Use &quot;correct answer&quot; files for check?</label></div>
            <select id="edit-use_corr" name="use_corr" onchange="filesDialogOnChange()">
<%
  if (sup_prob) {
%>
                <option value="-1">Default</option>
<%
  }
%>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>

        <div id="edit-corr_dir-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-corr_dir">Directory with &quot;correct answer&quot; files:</label></div>
            <input type="text" size="20" name="corr_dir" id="edit-corr_dir" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('corr_dir')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="corr_dir-dflt" id="edit-corr_dir-dflt" value="1" onchange="filesDialogOnChange('corr_dir-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-corr_pat-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-corr_pat">Pattern for &quot;correct answer&quot; file names:</label></div>
            <input type="text" size="20" name="corr_pat" id="edit-corr_pat" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('corr_pat')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="corr_pat-dflt" id="edit-corr_pat-dflt" value="1" onchange="filesDialogOnChange('corr_pat-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-corr_sfx-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-corr_sfx">Suffix of &quot;correct answer&quot; files:</label></div>
            <input type="text" size="20" name="corr_sfx" id="edit-corr_sfx" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('corr_sfx')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="corr_sfx-dflt" id="edit-corr_sfx-dflt" value="1" onchange="filesDialogOnChange('corr_sfx-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-use_info-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-use_info">Use test info files for check?</label></div>
            <select id="edit-use_info" name="use_info" onchange="filesDialogOnChange()">
<%
  if (sup_prob) {
%>
                <option value="-1">Default</option>
<%
  }
%>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>

        <div id="edit-info_dir-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-info_dir">Directory with test info files:</label></div>
            <input type="text" size="20" name="info_dir" id="edit-info_dir" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('info_dir')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="info_dir-dflt" id="edit-info_dir-dflt" value="1" onchange="filesDialogOnChange(info_dir-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-info_pat-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-info_pat">Pattern for test info file names:</label></div>
            <input type="text" size="20" name="info_pat" id="edit-info_pat" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('info_pat')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="info_pat-dflt" id="edit-info_pat-dflt" value="1" onchange="filesDialogOnChange('info_pat-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-info_sfx-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-info_sfx">Suffix of test info:</label></div>
            <input type="text" size="20" name="info_sfx" id="edit-info_sfx" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('info_sfx')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="info_sfx-dflt" id="edit-info_sfx-dflt" value="1" onchange="filesDialogOnChange('info_sfx-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-use_tgz-div">
            <div style="width: 250px; display: inline-block;"><label for="edit-use_tgz">Use special working directory for check?</label></div>
            <select id="edit-use_tgz" name="use_tgz" onchange="filesDialogOnChange()">
<%
  if (sup_prob) {
%>
                <option value="-1">Default</option>
<%
  }
%>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>

        <div id="edit-tgz_pat-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-tgz_pat">Pattern for working dir archives:</label></div>
            <input type="text" size="20" name="tgz_pat" id="edit-tgz_pat" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('tgz_pat')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="tgz_pat-dflt" id="edit-tgz_pat-dflt" value="1" onchange="filesDialogOnChange('tgz_pat-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-tgzdir_pat-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-tgzdir_pat">Pattern for master working dirs:</label></div>
            <input type="text" size="20" name="tgzdir_pat" id="edit-tgzdir_pat" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('tgzdir_pat')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="tgzdir_pat-dflt" id="edit-tgzdir_pat-dflt" value="1" onchange="filesDialogOnChange('tgzdir_pat-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-tgz_sfx-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-tgz_sfx">Suffix of working dir archives:</label></div>
            <input type="text" size="20" name="tgz_sfx" id="edit-tgz_sfx" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('tgz_sfx')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="tgz_sfx-dflt" id="edit-tgz_sfx-dflt" value="1" onchange="filesDialogOnChange('tgz_sfx-dflt')" />)<%
  }
%>
        </div>

        <div id="edit-tgzdir_sfx-div">
            <div style="width: 250px; display: inline-block;"><label style="display:block; width: 250px" for="edit-tgzdir_sfx">Suffix of master working dirs:</label></div>
            <input type="text" size="20" name="tgzdir_sfx" id="edit-tgzdir_sfx" value="" class="text ui-widget-content ui-corner-all" onchange="filesDialogOnChange('tgzdir_sfx')" /><%
  if (sup_prob) {
%>(Default: <input type="checkbox" name="tgzdir_sfx-dflt" id="edit-tgzdir_sfx-dflt" value="1" onchange="filesDialogOnChange('tgzdir_sfx-dflt')" />)<%
  }
%>
        </div>

    </s:form>
</div>

<h2><%
    if (prob_id <= 0) {
%>Abstract problem <%
    } else {
%>Problem <%
    }
%><s:v value="i" /><%
    if (prob->short_name && prob->short_name[0]) {
%>, <s:v value="prob->short_name" /><%
    }
%><%
    if (prob->internal_name && prob->internal_name[0]) {
%>, <s:v value="prob->internal_name" /><%
    }
%><%
    if (prob->long_name && prob->long_name[0]) {
%>, <s:v value="prob->long_name" /><%
    }
%></h2>

<script type="text/javascript">
var prob_id = <s:v value="prob_id" />;
</script>

<script type="text/javascript">
$(function() {
    $('#ProblemAccordion').accordion({ heightStyle: "content" });

    idDialog = $("#IdDialogDiv").dialog({
        autoOpen: false,
        height: 350,
        width: 650,
        modal: true,
        buttons: {
            "Save": function() {
                var postData = $("#IdDialogForm").serialize();
                var formURL = $("#IdDialogForm").attr("action");
                $.ajax({
                    url : formURL,
                    type: "POST",
                    data : postData,
                    success:function(data, textStatus, jqXHR) {
                        //data: return data from server
                        document.location.reload(true);
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        //if fails     
                    }
                });
            },
            Cancel: function() {
                idDialog.dialog("close");
            }
        },
        close : function() {
        }
    });

    $("#orig-autoassign_variants-div").toggle(<s:v type="jsbool" value="prob->variant_num > 0" />);

    filesDialog = $("#FilesDialogDiv").dialog({
        autoOpen: false,
        height: 500,
        width: 700,
        modal: true,
        buttons: {
            "Save": function() {
                var postData = $("#FilesDialogForm").serialize();
                var formURL = $("#FilesDialogForm").attr("action");
                $.ajax({
                    url : formURL,
                    type: "POST",
                    data : postData,
                    success:function(data, textStatus, jqXHR) {
                        //data: return data from server
                        document.location.reload(true);
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        //if fails     
                    }
                });
            },
            Cancel: function() {
                filesDialog.dialog("close");
            }
        },
        close : function() {
        }
    });

    $("#orig-normalization-div").toggle(<s:v type="jsbool" value="tmp_prob->binary_input <= 0" />);
    $("#orig-test_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0" />);

    $("#orig-corr_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0 && tmp_prob->use_corr > 0" />);
    $("#orig-corr_sfx-div").toggle(<s:v type="jsbool" value="tmp_prob->use_corr > 0" />);
    $("#orig-corr_pat-div").toggle(<s:v type="jsbool" value="tmp_prob->use_corr > 0" />);

    $("#orig-info_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0 && tmp_prob->use_info > 0" />);
    $("#orig-info_sfx-div").toggle(<s:v type="jsbool" value="tmp_prob->use_info > 0" />);
    $("#orig-info_pat-div").toggle(<s:v type="jsbool" value="tmp_prob->use_info > 0" />);

    $("#orig-tgz_sfx-div").toggle(<s:v type="jsbool" value="tmp_prob->use_tgz > 0" />);
    $("#orig-tgz_pat-div").toggle(<s:v type="jsbool" value="tmp_prob->use_tgz > 0" />);
    $("#orig-tgzdir_sfx-div").toggle(<s:v type="jsbool" value="tmp_prob->use_tgz > 0" />);
    $("#orig-tgzdir_pat-div").toggle(<s:v type="jsbool" value="tmp_prob->use_tgz > 0" />);
});

function np(e)
{
    if (e) e.stopPropagation();
}

function copyCheckbox(dst, src)
{
    var dstobj = document.getElementById(dst);
    var srcobj = document.getElementById(src);
    if (dstobj != null) {
        if (srcobj != null && srcobj.value == "1") {
            dstobj.checked = true;
        } else {
            dstobj.checked = false;
        }
    }
}

function toBool(str, def)
{
    if (str == "-1") {
        return def;
    } else if (str == "1") {
        return true;
    } else {
        return false;
    }
}

function popupIdDialog(e, skipField)
{
    $("#IdDialogProbId").val(prob_id);
    $("#edit-prob_id").val(prob_id);
    $("#edit-short_name").val($("#orig-short_name").val());
    $("#edit-internal_name").val($("#orig-internal_name").val());
    $("#edit-long_name").val($("#orig-long_name").val());
    $("#edit-super").val($("#orig-super").val());
    $("#edit-type").val($("#orig-type").val());
    $("#edit-variant_num").val($("#orig-variant_num").val());
    $("#edit-autoassign_variants").val($("#orig-autoassign_variants").val());

    if (e) e.stopPropagation();
    idDialogOnChange();
    $("#IdDialogDiv").dialog('open');
}

function idDialogOnChange()
{
    var num = parseInt($("#edit-variant_num").val());
    $("#edit-autoassign_variants-div").toggle(num > 0);
}

function popupFilesDialog(e, skipField)
{
    $("#FilesDialogProbId").val(prob_id);
    $("#edit-binary_input").val($("#orig-binary_input").val());
    $("#edit-normalization").val($("#orig-normalization").val());

    $("#edit-xml_file").val($("#orig-xml_file").val());
<%
  if (sup_prob) {
%>
    $("#edit-xml_file-dflt").prop('checked', <s:v type="jsbool" value="!prob->xml_file[0]" />);
<%
  }
%>

    $("#edit-test_dir").val($("#orig-test_dir").val());
<%
  if (sup_prob) {
%>
    $("#edit-test_dir-dflt").prop('checked', <s:v type="jsbool" value="!prob->test_dir[0]" />);
<%
  }
%>

    $("#edit-test_pat").val($("#orig-test_pat").val());
<%
  if (sup_prob) {
%>
    $("#edit-test_pat-dflt").prop('checked', <s:v type="jsbool" value="prob->test_pat[0] == 1" />);
<%
  }
%>

    $("#edit-test_sfx").val($("#orig-test_sfx").val());
<%
  if (sup_prob) {
%>
    $("#edit-test_sfx-dflt").prop('checked', <s:v type="jsbool" value="prob->test_sfx[0] == 1" />);
<%
  }
%>

    $("#edit-use_corr").val($("#orig-use_corr").val());
    $("#edit-corr_dir").val($("#orig-corr_dir").val());
<%
  if (sup_prob) {
%>
    $("#edit-corr_dir-dflt").prop('checked', <s:v type="jsbool" value="!prob->corr_dir[0]" />);
<%
  }
%>
    $("#edit-corr_pat").val($("#orig-corr_pat").val());
<%
  if (sup_prob) {
%>
    $("#edit-corr_pat-dflt").prop('checked', <s:v type="jsbool" value="prob->corr_pat[0] == 1" />);
<%
  }
%>
    $("#edit-corr_sfx").val($("#orig-corr_sfx").val());
<%
  if (sup_prob) {
%>
    $("#edit-corr_sfx-dflt").prop('checked', <s:v type="jsbool" value="prob->corr_sfx[0] == 1" />);
<%
  }
%>

    $("#edit-use_info").val($("#orig-use_info").val());
    $("#edit-info_dir").val($("#orig-info_dir").val());
<%
  if (sup_prob) {
%>
    $("#edit-info_dir-dflt").prop('checked', <s:v type="jsbool" value="!prob->info_dir[0]" />);
<%
  }
%>
    $("#edit-info_pat").val($("#orig-info_pat").val());
<%
  if (sup_prob) {
%>
    $("#edit-info_pat-dflt").prop('checked', <s:v type="jsbool" value="prob->info_pat[0] == 1" />);
<%
  }
%>
    $("#edit-info_sfx").val($("#orig-info_sfx").val());
<%
  if (sup_prob) {
%>
    $("#edit-info_sfx-dflt").prop('checked', <s:v type="jsbool" value="prob->info_sfx[0] == 1" />);
<%
  }
%>

    $("#edit-use_tgz").val($("#orig-use_tgz").val());
    $("#edit-tgz_pat").val($("#orig-tgz_pat").val());
<%
  if (sup_prob) {
%>
    $("#edit-tgz_pat-dflt").prop('checked', <s:v type="jsbool" value="prob->tgz_pat[0] == 1" />);
<%
  }
%>
    $("#edit-tgz_sfx").val($("#orig-tgz_sfx").val());
<%
  if (sup_prob) {
%>
    $("#edit-tgz_sfx-dflt").prop('checked', <s:v type="jsbool" value="prob->tgz_sfx[0] == 1" />);
<%
  }
%>
    $("#edit-tgzdir_pat").val($("#orig-tgzdir_pat").val());
<%
  if (sup_prob) {
%>
    $("#edit-tgzdir_pat-dflt").prop('checked', <s:v type="jsbool" value="prob->tgzdir_pat[0] == 1" />);
<%
  }
%>
    $("#edit-tgzdir_sfx").val($("#orig-tgzdir_sfx").val());
<%
  if (sup_prob) {
%>
    $("#edit-tgzdir_sfx-dflt").prop('checked', <s:v type="jsbool" value="prob->tgzdir_sfx[0] == 1" />);
<%
  }
%>

    if (e) e.stopPropagation();
    filesDialogOnChange();
    $("#FilesDialogDiv").dialog('open');
}

function filesDialogOnChange(field)
{
    $("#edit-normalization-div").toggle(!toBool($("#edit-binary_input").val(), <s:v type="jsbool" value="sup_prob && sup_prob->binary_input > 0" />));
    if (field == "xml_file-dflt") {
        if ($("#edit-xml_file-dflt").is(':checked')) {
            $("#edit-xml_file").val("");
        }
    } else if (field == "xml_file") {
        if ($("#edit-xml_file").val() != "") {
            $("#edit-xml_file-dflt").prop('checked', false);
        }
    }

    $("#edit-test_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0" />);
    if (field == "test_dir-dflt") {
        if ($("#edit-test_dir-dflt").is(':checked')) {
            $("#edit-test_dir").val("");
        }
    } else if (field == "test_dir") {
        if ($("#edit-test_dir").val() != "") {
            $("#edit-test_dir-dflt").prop('checked', false);
        }
    }
    if (field == "test_pat-dflt") {
        if ($("#edit-test_pat-dflt").is(':checked')) {
            $("#edit-test_pat").val("");
        }
    } else if (field == "test_pat") {
        if ($("#edit-test_pat").val() != "") {
            $("#edit-test_pat-dflt").prop('checked', false);
        }
    }
    if (field == "test_sfx-dflt") {
        if ($("#edit-test_sfx-dflt").is(':checked')) {
            $("#edit-test_sfx").val("");
        }
    } else if (field == "test_sfx") {
        if ($("#edit-test_sfx").val() != "") {
            $("#edit-test_sfx-dflt").prop('checked', false);
        }
    }

    $("#edit-corr_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0" /> && toBool($("#edit-use_corr").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_corr > 0" />));
    $("#edit-corr_sfx-div").toggle(toBool($("#edit-use_corr").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_corr > 0" />));
    $("#edit-corr_pat-div").toggle(toBool($("#edit-use_corr").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_corr > 0" />));

    if (field == "corr_dir-dflt") {
        if ($("#edit-corr_dir-dflt").is(':checked')) {
            $("#edit-corr_dir").val("");
        }
    } else if (field == "corr_dir") {
        if ($("#edit-corr_dir").val() != "") {
            $("#edit-corr_dir-dflt").prop('checked', false);
        }
    }
    if (field == "corr_pat-dflt") {
        if ($("#edit-corr_pat-dflt").is(':checked')) {
            $("#edit-corr_pat").val("");
        }
    } else if (field == "corr_pat") {
        if ($("#edit-corr_pat").val() != "") {
            $("#edit-corr_pat-dflt").prop('checked', false);
        }
    }
    if (field == "corr_sfx-dflt") {
        if ($("#edit-corr_sfx-dflt").is(':checked')) {
            $("#edit-corr_sfx").val("");
        }
    } else if (field == "corr_sfx") {
        if ($("#edit-corr_sfx").val() != "") {
            $("#edit-corr_sfx-dflt").prop('checked', false);
        }
    }

    $("#edit-info_dir-div").toggle(<s:v type="jsbool" value="global->advanced_layout <= 0" /> && toBool($("#edit-use_info").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_info > 0" />));
    $("#edit-info_sfx-div").toggle(toBool($("#edit-use_info").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_info > 0" />));
    $("#edit-info_pat-div").toggle(toBool($("#edit-use_info").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_info > 0" />));

    if (field == "info_dir-dflt") {
        if ($("#edit-info_dir-dflt").is(':checked')) {
            $("#edit-info_dir").val("");
        }
    } else if (field == "info_dir") {
        if ($("#edit-info_dir").val() != "") {
            $("#edit-info_dir-dflt").prop('checked', false);
        }
    }
    if (field == "info_pat-dflt") {
        if ($("#edit-info_pat-dflt").is(':checked')) {
            $("#edit-info_pat").val("");
        }
    } else if (field == "info_pat") {
        if ($("#edit-info_pat").val() != "") {
            $("#edit-info_pat-dflt").prop('checked', false);
        }
    }
    if (field == "info_sfx-dflt") {
        if ($("#edit-info_sfx-dflt").is(':checked')) {
            $("#edit-info_sfx").val("");
        }
    } else if (field == "info_sfx") {
        if ($("#edit-info_sfx").val() != "") {
            $("#edit-info_sfx-dflt").prop('checked', false);
        }
    }

    $("#edit-tgz_sfx-div").toggle(toBool($("#edit-use_tgz").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_tgz > 0" />));
    $("#edit-tgz_pat-div").toggle(toBool($("#edit-use_tgz").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_tgz > 0" />));
    $("#edit-tgzdir_sfx-div").toggle(toBool($("#edit-use_tgz").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_tgz > 0" />));
    $("#edit-tgzdir_pat-div").toggle(toBool($("#edit-use_tgz").val(), <s:v type="jsbool" value="sup_prob && sup_prob->use_tgz > 0" />));

    if (field == "tgz_pat-dflt") {
        if ($("#edit-tgz_pat-dflt").is(':checked')) {
            $("#edit-tgz_pat").val("");
        }
    } else if (field == "tgz_pat") {
        if ($("#edit-tgz_pat").val() != "") {
            $("#edit-tgz_pat-dflt").prop('checked', false);
        }
    }
    if (field == "tgz_sfx-dflt") {
        if ($("#edit-tgz_sfx-dflt").is(':checked')) {
            $("#edit-tgz_sfx").val("");
        }
    } else if (field == "tgz_sfx") {
        if ($("#edit-tgz_sfx").val() != "") {
            $("#edit-tgz_sfx-dflt").prop('checked', false);
        }
    }
    if (field == "tgzdir_pat-dflt") {
        if ($("#edit-tgzdir_pat-dflt").is(':checked')) {
            $("#edit-tgzdir_pat").val("");
        }
    } else if (field == "tgzdir_pat") {
        if ($("#edit-tgzdir_pat").val() != "") {
            $("#edit-tgzdir_pat-dflt").prop('checked', false);
        }
    }
    if (field == "tgzdir_sfx-dflt") {
        if ($("#edit-tgzdir_sfx-dflt").is(':checked')) {
            $("#edit-tgzdir_sfx").val("");
        }
    } else if (field == "tgzdir_sfx") {
        if ($("#edit-tgzdir_sfx").val() != "") {
            $("#edit-tgzdir_sfx-dflt").prop('checked', false);
        }
    }
}

</script>

<div id="ProblemAccordion">
    <h3>Problem identification</h3>
    <div>
        <table border="0" onclick="popupIdDialog()">

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-id-div">
                <td>ID:</td>
                <td><s:textfield id="orig-id" readonly="readonly" name="param" value="prob->id" size="48" maxlength="1024" check="false" /></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-short_name-div">
                <td>Short name:</td>
                <td><s:textfield id="orig-short_name" readonly="readonly" name="param" value="prob->short_name" size="48" maxlength="1024" check="no" /><% if (!prob->short_name) { %>(<i>Not set</i>)<% } %></td>
                <td><input type="button" onclick="popupIdDialog(event, 'short_name')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:short_name" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-internal_name-div">
                <td>Internal name:</td>
                <td><s:textfield id="orig-internal_name" readonly="readonly" name="param" value="prob->internal_name" size="48" maxlength="1024" check="no" /><% if (!prob->internal_name) { %>(<i>Not set</i>)<% } %></td>
                <td><input type="button" onclick="popupIdDialog(event, 'internal_name')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:internal_name" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-long_name-div">
                <td>Long name:</td>
                <td><s:textfield id="orig-long_name" readonly="readonly" name="param" value="prob->long_name" size="48" maxlength="1024" check="no" /><% if (!prob->long_name) { %>(<i>Not set</i>)<% } %></td>
                <td><input type="button" onclick="popupIdDialog(event, 'long_name')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:long_name" /></td>
            </s:tr>

<%
    str_value = NULL;
    if (sup_prob && sup_prob->short_name && sup_prob->short_name[0]) {
        str_value = sup_prob->short_name;
    }
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-super-div">
                <td>Base abstract problem:</td>
                <td><s:textfield id="orig-super" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><% if (!str_value) { %>(<i>Not set</i>)<% } %></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:super" /></td>
            </s:tr>

<%
    prob_type = prob->type;
    if (prob_type < 0 || prob_type >= PROB_TYPE_LAST) prob_type = 0;
    str_value = problem_unparse_type(prob_type);
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-type-div">
                <td>Type:</td>
                <td><s:textfield id="orig-type" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><% if (!str_value) { %>(<i>Not set</i>)<% } %></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:type" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-variant_num-div">
                <td>Number of variants:</td>
                <td><s:textfield id="orig-variant_num" readonly="readonly" name="param" value="prob->variant_num" size="48" maxlength="1024" checkExpr="> 0" /><%
    if (prob->variant_num <= 0) {
%>(<i>No variants</i>)<%
    }
%></td>
                <td><%
    if (prob->variant_num > 0) {
%>[<s:a ac="cnts-start-edit-variant-action">Edit variants</s:a>]<%
    }
%></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:variant_num" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-autoassign_variants-div">
                <td>Assign variants automatically?</td>
                <td><%
    if (!sup_prob) {
%><s:yesno id="orig-autoassign_variants" readonly="readonly" name="param" value="tmp_prob->autoassign_variants" /><%
    } else {
%><s:yesno3 id="orig-autoassign_variants" readonly="readonly" name="param" value="prob->autoassign_variants" default="tmp_prob->autoassign_variants" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:autoassign_variants" /></td>
            </s:tr>

        </table>
    </div>

    <h3>Files and directories</h3>

    <div>
        <table border="0" onclick="popupFilesDialog()">

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-binary_input-div">
                <td>Input data is binary?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
%><s:yesno id="orig-binary_input" readonly="readonly" name="param" value="tmp_prob->binary_input" /><%
    } else {
%><s:yesno3 id="orig-binary_input" readonly="readonly" name="param" value="prob->binary_input" default="tmp_prob->binary_input" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:binary_input" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-normalization-div">
                <td>Test normalization mode:</td>
                <td><%
    value = test_normalization_parse(prob->normalization);
    if (value < 0) value = TEST_NORM_DEFAULT;
    if (!sup_prob) {
      if (value == TEST_NORM_DEFAULT) value = TEST_NORM_NL;
%><s:hidden id="orig-normalization" name="param" value="value" /><s:v value="test_normalization_unparse_full(value)" escape="false" /><%
    } else if (value == TEST_NORM_DEFAULT) {
      value = test_normalization_parse(sup_prob->normalization);
      if (value < 0) value = TEST_NORM_NL;
%><s:hidden id="orig-normalization" name="param" value="value" /><%
      if (value == TEST_NORM_DEFAULT) value = TEST_NORM_NL;
%>Default (<s:v value="test_normalization_unparse_full(value)" escape="false" />)<%
    } else {
%><s:hidden id="orig-normalization" name="param" value="value" /><s:v value="test_normalization_unparse_full(value)" escape="false" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:normalization" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-xml_file-div">
                <td>XML File with problem statement:</td>
                <td><%
  str_value = prob->xml_file;
  if (str_value && str_value[0] < ' ') str_value = 0;
%><s:textfield id="orig-xml_file" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
  if (prob_id <= 0) {
%><% if (!str_value) { %>(<i>Not set</i>)<% } %><%
  } else if (!sup_prob) {
    if (!str_value) {
%>(<i>Not set</i>)<%
    } else {
%>(<i><s:v value="tmp_prob->xml_file" /></i>)<%
    }
  } else {
    if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->xml_file" /></i>)<%
    } else {
%>(<i><s:v value="tmp_prob->xml_file" /></i>)<%
    }
  }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'xml_file')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:xml_file" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_dir-div">
                <td>Directory with tests:</td>
                <td><%
    str_value = prob->test_dir;
    if (str_value && str_value[0] < ' ') str_value = 0;
%><s:textfield id="orig-test_dir" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value || !sup_prob) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->test_dir" /></i>)<%
      } else {
%>(<i><s:v value="tmp_prob->test_dir" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'test_dir')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_dir" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_pat-div">
                <td>Pattern for test file names:</td>
                <td><%
    str_value = prob->test_pat;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-test_pat" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->test_pat" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'test_pat')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_pat" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_sfx-div">
                <td>Suffix of test files:</td>
                <td><%
    str_value = prob->test_sfx;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-test_sfx" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->test_sfx" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'test_sfx')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_sfx" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_corr-div">
                <td>Use &quot;correct answer&quot; files for check?</td>
                <td><%
    if (!sup_prob) {
%><s:yesno id="orig-use_corr" readonly="readonly" name="param" value="value" /><%
    } else {
%><s:yesno3 id="orig-use_corr" readonly="readonly" name="param" value="prob->use_corr" default="tmp_prob->use_corr" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_corr" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-corr_dir-div">
                <td>Directory with &quot;correct answer&quot; files:</td>
                <td><%
    str_value = prob->corr_dir;
    if (str_value && str_value[0] < ' ') str_value = 0;
%><s:textfield id="orig-corr_dir" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0 || !sup_prob) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_corr_dir, tmp_prob, sup_prob, global);
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->corr_dir" /></i>)<%
      } else {
%>(<i><s:v value="tmp_prob->corr_dir" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'corr_dir')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:corr_dir" /></td>
            </s:tr>

<%
  if (prob_id > 0) {
    prepare_set_prob_value(CNTSPROB_corr_sfx, tmp_prob, sup_prob, global);
    prepare_set_prob_value(CNTSPROB_corr_pat, tmp_prob, sup_prob, global);
  }
%>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-corr_pat-div">
                <td>Pattern for &quot;correct answer&quot; file names:</td>
                <td><%
    str_value = prob->corr_pat;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-corr_pat" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->corr_pat" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'corr_pat')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:corr_pat" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-corr_sfx-div">
                <td>Suffix of &quot;correct answer&quot; files:</td>
                <td><%
    str_value = prob->corr_sfx;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-corr_sfx" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->corr_sfx" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'corr_sfx')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:corr_sfx" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_info-div">
                <td>Use test info files for check?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
%><s:yesno id="orig-use_info" readonly="readonly" name="param" value="value" /><%
    } else {
%><s:yesno3 id="orig-use_info" readonly="readonly" name="param" value="prob->use_info" default="tmp_prob->use_info" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_info" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-info_dir-div">
                <td>Directory with test info files:</td>
                <td><%
    str_value = prob->info_dir;
    if (str_value && str_value[0] < ' ') str_value = 0;
%><s:textfield id="orig-info_dir" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_info_dir, tmp_prob, sup_prob, global);
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->info_dir" /></i>)<%
      } else {
%>(<i><s:v value="tmp_prob->info_dir" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'info_dir')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:info_dir" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-info_pat-div">
                <td>Pattern for test info file names:</td>
                <td><%
    str_value = prob->info_pat;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-info_pat" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->info_pat" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'info_pat')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:info_pat" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-info_sfx-div">
                <td>Suffix of test info:</td>
                <td><%
    str_value = prob->info_sfx;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-info_sfx" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->info_sfx" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'info_sfx')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:info_sfx" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_tgz-div">
                <td>Use special working directory for check?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
%><s:yesno id="orig-use_tgz" readonly="readonly" name="param" value="value" /><%
    } else {
%><s:yesno3 id="orig-use_tgz" readonly="readonly" name="param" value="prob->use_tgz" default="tmp_prob->use_tgz" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_tgz" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tgz_pat-div">
                <td>Pattern for working dir archives:</td>
                <td><%
    str_value = prob->tgz_pat;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-tgz_pat" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->tgz_pat" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'tgz_pat')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tgz_pat" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tgzdir_pat-div">
                <td>Pattern for master working dirs:</td>
                <td><%
    str_value = prob->tgzdir_pat;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-tgzdir_pat" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->tgzdir_pat" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'tgzdir_pat')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tgzdir_pat" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tgz_sfx-div">
                <td>Suffix of working dir archives:</td>
                <td><%
    str_value = prob->tgz_sfx;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-tgz_sfx" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->tgz_sfx" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'tgz_sfx')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tgz_sfx" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tgzdir_sfx-div">
                <td>Suffix of master working dirs:</td>
                <td><%
    str_value = prob->tgzdir_sfx;
    if (str_value[0] == 1) str_value = 0;
%><s:textfield id="orig-tgzdir_sfx" readonly="readonly" name="param" value="str_value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!str_value) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (!sup_prob && !str_value) {
%>(<i>Not set</i>)<%
      } else if (!str_value) {
%>(<i>Default: <s:v value="tmp_prob->tgzdir_sfx" /></i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupFilesDialog(event, 'tgzdir_sfx')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tgzdir_sfx" /></td>
            </s:tr>

        </table>
    </div>

    <h3>Validation</h3>

    <div>
        <table border="0" onclick="popupValidationDialog()">

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_checker_cmd-div">
                <td>Test checker name:</td>
                <td><%
%><s:textfield id="orig-test_checker_cmd" readonly="readonly" name="param" value="prob->test_checker_cmd" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!prob->test_checker_cmd) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_test_checker_cmd, tmp_prob, sup_prob, global);
      if (!prob->test_checker_cmd) {
        if (!tmp_prob->test_checker_cmd || !tmp_prob->test_checker_cmd[0]) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->test_checker_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupValidationDialog(event, 'test_checker_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_checker_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_checker_env-div">
                <td>Test checker environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->test_checker_env && prob->test_checker_env[0]) strs = sarray_unparse(prob->test_checker_env);
%><s:textfield id="orig-test_checker_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupValidationDialog(event, 'test_checker_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_checker_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-solution_src-div">
                <td>Solution source name:</td>
                <td><%
%><s:textfield id="orig-solution_src" readonly="readonly" name="param" value="prob->solution_src" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!prob->solution_src) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_solution_src, tmp_prob, sup_prob, global);
      if (!prob->solution_src) {
        if (!tmp_prob->solution_src || !tmp_prob->solution_src[0]) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->solution_src" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupValidationDialog(event, 'solution_src')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:solution_src" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-solution_cmd-div">
                <td>Solution command:</td>
                <td><%
%><s:textfield id="orig-solution_cmd" readonly="readonly" name="param" value="prob->solution_cmd" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!prob->solution_cmd) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_solution_cmd, tmp_prob, sup_prob, global);
      if (!prob->solution_cmd) {
        if (!tmp_prob->solution_cmd || !tmp_prob->solution_cmd[0]) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->solution_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupValidationDialog(event, 'solution_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:solution_cmd" /></td>
            </s:tr>
<%
  }
%>




        </table>
    </div>

    <h3>Statement view</h3>

    <div>
        <table border="0" onclick="popupStatementDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_tab-div">
                <td>Disable problem tab?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_tab == 1);
%><s:yesno id="orig-disable_tab" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_tab, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_tab" readonly="readonly" name="param" value="prob->disable_tab" default="tmp_prob->disable_tab" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_tab" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-unrestricted_statement-div">
                <td>Unrestricted problem statement?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->unrestricted_statement == 1);
%><s:yesno id="orig-unrestricted_statement" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_unrestricted_statement, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-unrestricted_statement" readonly="readonly" name="param" value="prob->unrestricted_statement" default="tmp_prob->unrestricted_statement" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:unrestricted_statement" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-hide_file_names-div">
                <td>Hide input/output file names from problem statement?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->hide_file_names == 1);
%><s:yesno id="orig-hide_file_names" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_hide_file_names, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-hide_file_names" readonly="readonly" name="param" value="prob->hide_file_names" default="tmp_prob->hide_file_names" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:hide_file_names" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-hide_real_time_limit-div">
                <td>Hide real-time limit from problem statement?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->hide_real_time_limit == 1);
%><s:yesno id="orig-hide_real_time_limit" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_hide_real_time_limit, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-hide_real_time_limit" readonly="readonly" name="param" value="prob->hide_real_time_limit" default="tmp_prob->hide_real_time_limit" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:hide_real_time_limit" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-hide_variant-div">
                <td>Hide variant from user?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->hide_variant == 1);
%><s:yesno id="orig-hide_variant" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_hide_variant, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-hide_variant" readonly="readonly" name="param" value="prob->hide_variant" default="tmp_prob->hide_variant" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:hide_variant" /></td>
            </s:tr>
<%
  }
%>






        </table>
    </div>

    <h3>Submission</h3>

    <div>
        <table border="0" onclick="popupSubmissionDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_user_submit-div">
                <td>Disable user submissions?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_user_submit == 1);
%><s:yesno id="orig-disable_user_submit" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_user_submit, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_user_submit" readonly="readonly" name="param" value="prob->disable_user_submit" default="tmp_prob->disable_user_submit" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_user_submit" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_submit_after_ok-div">
                <td>Disable submissions after OK?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_submit_after_ok == 1);
%><s:yesno id="orig-disable_submit_after_ok" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_submit_after_ok, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_submit_after_ok" readonly="readonly" name="param" value="prob->disable_submit_after_ok" default="tmp_prob->disable_submit_after_ok" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_submit_after_ok" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-binary-div">
                <td>Submit is binary?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->binary == 1;
%><s:yesno id="orig-binary" readonly="readonly" name="param" value="value" /><%
    } else {
      //prepare_set_prob_value(CNTSPROB_binary, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-binary" readonly="readonly" name="param" value="prob->binary" default="tmp_prob->binary" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:binary" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_user_run_count-div">
                <td>Max submissions for the problem:</td>
                <td><s:textfield id="orig-max_user_run_count" readonly="readonly" name="param" value="prob->max_user_run_count" size="48" maxlength="1024" checkExpr=">= 0" /><%
    if (prob_id <= 0) {
      if (prob->max_user_run_count < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_user_run_count, tmp_prob, sup_prob, global);
      if (prob->max_user_run_count < 0 && tmp_prob->max_user_run_count < 0) {
%>(<i>Not set</i>)<%
      } else {
%>(<i>Default: <s:v value="tmp_prob->max_user_run_count" /></i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_user_run_count" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-advance_to_next-div">
                <td>Automatically advance to the next problem?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->advance_to_next == 1);
%><s:yesno id="orig-advance_to_next" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_advance_to_next, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-advance_to_next" readonly="readonly" name="param" value="prob->advance_to_next" default="tmp_prob->advance_to_next" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:advance_to_next" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_ctrl_chars-div">
                <td>Disable any control characters in the source code?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_ctrl_chars == 1);
%><s:yesno id="orig-disable_ctrl_chars" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_ctrl_chars, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_ctrl_chars" readonly="readonly" name="param" value="prob->disable_ctrl_chars" default="tmp_prob->disable_ctrl_chars" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_ctrl_chars" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-enable_text_form-div">
                <td>Enable textarea input form?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->enable_text_form == 1);
%><s:yesno id="orig-enable_text_form" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_enable_text_form, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-enable_text_form" readonly="readonly" name="param" value="prob->enable_text_form" default="tmp_prob->enable_text_form" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:enable_text_form" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_language-div">
                <td>Disabled languages:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->disable_language && prob->disable_language[0]) strs = sarray_unparse(prob->disable_language);
%><s:textfield id="orig-disable_language" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupSubmissionDialog(event, 'disable_language')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_language" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-enable_language-div">
                <td>Enabled languages:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->enable_language && prob->enable_language[0]) strs = sarray_unparse(prob->enable_language);
%><s:textfield id="orig-enable_language" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupSubmissionDialog(event, 'enable_language')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:enable_language" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-require-div">
                <td>Required problems:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->require && prob->require[0]) strs = sarray_unparse(prob->require);
%><s:textfield id="orig-require" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupSubmissionDialog(event, 'require')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:require" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-start_date-div">
                <td>Accept start date:</td>
                <td><% html_date_select(out_f, prob->start_date); %></td>
                <td><s:submit ac="prob-change-start-date" label="Change" /><s:submit ac="prob-clear-start-date" label="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:start_date" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-deadline-div">
                <td>Accept deadline:</td>
                <td><% html_date_select(out_f, prob->deadline); %></td>
                <td><s:submit ac="prob-change-deadline" label="Change" /><s:submit ac="prob-clear-deadline" label="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:deadline" /></td>
            </s:tr>
<%
  }
%>

        </table>
    </div>

    <h3>Compiling</h3>

    <div>
        <table border="0" onclick="popupCompilingDialog()">

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-style_checker_cmd-div">
                <td>Style checker name:</td>
                <td><%
    const unsigned char *value = prob->style_checker_cmd;
    if (value && (!value[0] || value[0] == 1)) value = 0;
%><s:textfield id="orig-style_checker_cmd" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_style_checker_cmd, tmp_prob, sup_prob, global);
      if (!value) {
        if (!tmp_prob->style_checker_cmd[0] || tmp_prob->style_checker_cmd[0] == 1) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->style_checker_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCompilingDialog(event, 'style_checker_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:style_checker_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-style_checker_env-div">
                <td>Style checker environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->style_checker_env && prob->style_checker_env[0]) strs = sarray_unparse(prob->style_checker_env);
%><s:textfield id="orig-style_checker_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCompilingDialog(event, 'style_checker_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:style_checker_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-lang_compiler_env-div">
                <td>Compiler environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->lang_compiler_env && prob->lang_compiler_env[0]) strs = sarray_unparse(prob->lang_compiler_env);
%><s:textfield id="orig-lang_compiler_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCompilingDialog(event, 'lang_compiler_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:lang_compiler_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-source_header-div">
                <td>Source header file:</td>
                <td><%
    const unsigned char *value = prob->source_header;
    if (value && value[0] == 1) value = 0;
%><s:textfield id="orig-source_header" readonly="readonly" name="param" value="prob->source_header" size="48" maxlength="1024" checkExpr="> 0" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_source_header, tmp_prob, sup_prob, global);
      if (!value) {
        if (tmp_prob->source_header[0] == 1) {
%>(<i>Not set</i>)<%
        } else if (!tmp_prob->source_header[0]) {
%>(<i>Default: none</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->source_header" /></i>)<%
        }
      } else if (!value[0]) {
%>(<i>None</i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupCompilingDialog(event, 'source_header')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:source_header" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-source_footer-div">
                <td>Source footer file:</td>
                <td><%
    const unsigned char *value = prob->source_footer;
    if (value && value[0] == 1) value = 0;
%><s:textfield id="orig-source_footer" readonly="readonly" name="param" value="prob->source_footer" size="48" maxlength="1024" checkExpr="> 0" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_source_footer, tmp_prob, sup_prob, global);
      if (!value) {
        if (tmp_prob->source_footer[0] == 1) {
%>(<i>Not set</i>)<%
        } else if (!tmp_prob->source_footer[0]) {
%>(<i>Default: none</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->source_footer" /></i>)<%
        }
      } else if (!value[0]) {
%>(<i>None</i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupCompilingDialog(event, 'source_footer')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:source_footer" /></td>
            </s:tr>
<%
  }
%>




        </table>
    </div>


    <h3>Running</h3>

    <div>
        <table border="0" onclick="popupCheckingDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_testing-div">
                <td>Disable any testing of submissions?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_testing == 1);
%><s:yesno id="orig-disable_testing" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_testing, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_testing" readonly="readonly" name="param" value="prob->disable_testing" default="tmp_prob->disable_testing" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_testing" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_auto_testing-div">
                <td>Disable automatic testing of submissions?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_auto_testing == 1);
%><s:yesno id="orig-disable_auto_testing" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_auto_testing, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_auto_testing" readonly="readonly" name="param" value="prob->disable_auto_testing" default="tmp_prob->disable_auto_testing" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_auto_testing" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-enable_compilation-div">
                <td>Still compile runs to mark as ACCEPTED?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->enable_compilation == 1);
%><s:yesno id="orig-enable_compilation" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_enable_compilation, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-enable_compilation" readonly="readonly" name="param" value="prob->enable_compilation" default="tmp_prob->enable_compilation" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:enable_compilation" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-manual_checking-div">
                <td>Problem is checked manually?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->manual_checking > 0);
%><s:yesno id="orig-manual_checking" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_manual_checking, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-manual_checking" readonly="readonly" name="param" value="prob->manual_checking" default="tmp_prob->manual_checking" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:manual_checking" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-check_presentation-div">
                <td>Check output presentation anyway?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->check_presentation > 0);
%><s:yesno id="orig-check_presentation" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_check_presentation, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-check_presentation" readonly="readonly" name="param" value="prob->check_presentation" default="tmp_prob->check_presentation" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:check_presentation" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_stdin-div">
                <td>Use standard input?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->use_stdin;
%><s:yesno id="orig-use_stdin" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_use_stdin, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-use_stdin" readonly="readonly" name="param" value="prob->use_stdin" default="tmp_prob->use_stdin" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_stdin" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-combined_stdin-div">
                <td>Combined standard/file input?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->combined_stdin;
%><s:yesno id="orig-combined_stdin" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_combined_stdin, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-combined_stdin" readonly="readonly" name="param" value="prob->combined_stdin" default="tmp_prob->combined_stdin" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:combined_stdin" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-input_file-div">
                <td>Input file name:</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      const unsigned char *value = prob->input_file;
      if (value && value[0] < ' ') value = 0;
%><s:textfield id="orig-input_file" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><% if (!value) { %>(<i>Not set</i>)<% } %><%
    } else {
      prepare_set_prob_value(CNTSPROB_input_file, tmp_prob, sup_prob, global);
      const unsigned char *value = prob->input_file;
      if (value && value[0] < ' ') value = 0;
%><s:textfield id="orig-input_file" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><% if (!value) { %>(<i>Default</i>: <i><s:v value="tmp_prob->input_file" /></i>)<% } %><%
    }
%></td>
                <td><input type="button" onclick="popupCheckingDialog(event, 'input_file')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:input_file" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_stdout-div">
                <td>Use standard output?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->use_stdout;
%><s:yesno id="orig-use_stdout" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_use_stdout, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-use_stdout" readonly="readonly" name="param" value="prob->use_stdout" default="tmp_prob->use_stdout" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_stdout" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-combined_stdout-div">
                <td>Combined standard/file output?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->combined_stdout;
%><s:yesno id="orig-combined_stdout" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_combined_stdout, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-combined_stdout" readonly="readonly" name="param" value="prob->combined_stdout" default="tmp_prob->combined_stdout" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:combined_stdout" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-output_file-div">
                <td>Output file name:</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      const unsigned char *value = prob->output_file;
      if (value && value[0] < ' ') value = 0;
%><s:textfield id="orig-output_file" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><% if (!value) { %>(<i>Not set</i>)<% } %><%
    } else {
      prepare_set_prob_value(CNTSPROB_output_file, tmp_prob, sup_prob, global);
      const unsigned char *value = prob->output_file;
      if (value && value[0] < ' ') value = 0;
%><s:textfield id="orig-output_file" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><% if (!value) { %>(<i>Default</i>: <i><s:v value="tmp_prob->output_file" /></i>)<% } %><%
    }
%></td>
                <td><input type="button" onclick="popupCheckingDialog(event, 'output_file')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:output_file" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_stderr-div">
                <td>Consider output to stderr as PE?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->disable_stderr == 1;
%><s:yesno id="orig-disable_stderr" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_stderr, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_stderr" readonly="readonly" name="param" value="prob->disable_stderr" default="tmp_prob->disable_stderr" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_stderr" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-ignore_exit_code-div">
                <td>Ignore exit code?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->ignore_exit_code == 1);
%><s:yesno id="orig-ignore_exit_code" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_ignore_exit_code, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-ignore_exit_code" readonly="readonly" name="param" value="prob->ignore_exit_code" default="tmp_prob->ignore_exit_code" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:ignore_exit_code" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-start_cmd-div">
                <td>Start proxy program:</td>
                <td><%
%><s:textfield id="orig-start_cmd" readonly="readonly" name="param" value="prob->start_cmd" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!prob->start_cmd) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_start_cmd, tmp_prob, sup_prob, global);
      if (!prob->start_cmd) {
        if (!tmp_prob->start_cmd || !tmp_prob->start_cmd[0]) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->start_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCheckingDialog(event, 'start_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:start_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-start_env-div">
                <td>Start environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->start_env && prob->start_env[0]) strs = sarray_unparse(prob->start_env);
%><s:textfield id="orig-start_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCheckingDialog(event, 'start_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:start_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>



        </table>
    </div>

    <h3>Limits</h3>

    <div>
        <table border="0" onclick="popupLimitsDialog()">

<%
  prepare_set_prob_value(CNTSPROB_time_limit, tmp_prob, sup_prob, global);
  prepare_set_prob_value(CNTSPROB_time_limit_millis, tmp_prob, sup_prob, global);
%>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-time_limit_millis-div">
                <td>Processor time limit (ms):</td>
                <td><s:textfield id="orig-time_limit_millis" readonly="readonly" name="param" value="prob->time_limit_millis" size="48" maxlength="1024" checkExpr=" > 0" /><%
    if (prob_id <= 0) {
      if (prob->time_limit_millis <= 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      if (prob->time_limit_millis <= 0 && tmp_prob->time_limit_millis <= 0) {
%>(<i>Not set</i>)<%
      } else if (prob->time_limit_millis <= 0) {
%>(<i>Default: <s:v value="tmp_prob->time_limit_millis" /></i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:time_limit_millis" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-time_limit-div">
                <td>Processor time limit (s):</td>
                <td><s:textfield id="orig-time_limit" readonly="readonly" name="param" value="prob->time_limit" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (!prob->time_limit) {
%>(<i>Unlimited</i>)<%
      }
    } else {
      if (prob->time_limit < 0 && tmp_prob->time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (prob->time_limit < 0 && !tmp_prob->time_limit) {
%>(<i>Default: Unlimited</i>)<%
      } else if (prob->time_limit < 0) {
%>(<i>Default: <s:v value="tmp_prob->time_limit" /></i>)<%
      } else if (!prob->time_limit) {
%>(<i>Unlimited</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:time_limit" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-real_time_limit-div">
                <td>Real time limit (s):</td>
                <td><s:textfield id="orig-real_time_limit" readonly="readonly" name="param" value="prob->real_time_limit" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->real_time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (!prob->real_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_real_time_limit, tmp_prob, sup_prob, global);
      if (prob->real_time_limit < 0 && tmp_prob->real_time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (prob->real_time_limit < 0 && !tmp_prob->real_time_limit) {
%>(<i>Default: Unlimited</i>)<%
      } else if (prob->real_time_limit < 0) {
%>(<i>Default: <s:v value="tmp_prob->real_time_limit" /></i>)<%
      } else if (!prob->real_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:real_time_limit" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_vm_size-div">
                <td>Maximum virtual memory size:</td>
                <td><%
    num_buf[0] = 0;
    if (prob->max_vm_size == ~(size_t) 0 && prob_id <= 0) {
      snprintf(num_buf, sizeof(num_buf), "%d", -1);
    } else if (prob->max_vm_size != ~(size_t) 0) {
      size_t_to_size_str(num_buf, sizeof(num_buf), prob->max_vm_size);
    }
%><s:textfield id="orig-max_vm_size" readonly="readonly" name="param" value="num_buf" size="48" maxlength="1024" check="no" /><%
    if (prob_id <= 0) {
      if (prob->max_vm_size == ~(size_t) 0 || prob->max_vm_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_vm_size, tmp_prob, sup_prob, global);
      if (prob->max_vm_size == ~(size_t) 0) {
        if (tmp_prob->max_vm_size == ~(size_t) 0) {
%>(<i>Default: unlimited</i>)<%
        } else if (tmp_prob->max_vm_size == 0) {
%>(<i>Default: OS Limit</i>)<%
        } else {
          size_t_to_size_str(num_buf, sizeof(num_buf), tmp_prob->max_vm_size);
%>(<i>Default: <s:v value="num_buf" escape="false"/></i>)<%
        }
      } else if (prob->max_vm_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_vm_size" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_stack_size-div">
                <td>Maximum stack size:</td>
                <td><%
    num_buf[0] = 0;
    if (prob->max_stack_size == ~(size_t) 0 && prob_id <= 0) {
      snprintf(num_buf, sizeof(num_buf), "%d", -1);
    } else if (prob->max_stack_size != ~(size_t) 0) {
      size_t_to_size_str(num_buf, sizeof(num_buf), prob->max_stack_size);
    }
%><s:textfield id="orig-max_stack_size" readonly="readonly" name="param" value="num_buf" size="48" maxlength="1024" check="no" /><%
    if (prob_id <= 0) {
      if (prob->max_stack_size == ~(size_t) 0 || prob->max_stack_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_stack_size, tmp_prob, sup_prob, global);
      if (prob->max_stack_size == ~(size_t) 0) {
        if (tmp_prob->max_stack_size == ~(size_t) 0) {
%>(<i>Default: unlimited</i>)<%
        } else if (tmp_prob->max_stack_size == 0) {
%>(<i>Default: OS Limit</i>)<%
        } else {
          size_t_to_size_str(num_buf, sizeof(num_buf), tmp_prob->max_stack_size);
%>(<i>Default: <s:v value="num_buf" escape="false"/></i>)<%
        }
      } else if (prob->max_stack_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_stack_size" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_file_size-div">
                <td>Maximum output file size:</td>
                <td><%
    num_buf[0] = 0;
    if (prob->max_file_size == ~(size_t) 0 && prob_id <= 0) {
      snprintf(num_buf, sizeof(num_buf), "%d", -1);
    } else if (prob->max_file_size != ~(size_t) 0) {
      size_t_to_size_str(num_buf, sizeof(num_buf), prob->max_file_size);
    }
%><s:textfield id="orig-max_file_size" readonly="readonly" name="param" value="num_buf" size="48" maxlength="1024" check="no" /><%
    if (prob_id <= 0) {
      if (prob->max_file_size == ~(size_t) 0 || prob->max_file_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_file_size, tmp_prob, sup_prob, global);
      if (prob->max_file_size == ~(size_t) 0) {
        if (tmp_prob->max_file_size == ~(size_t) 0) {
%>(<i>Default: OS Limit</i>)<%
        } else if (tmp_prob->max_file_size == 0) {
%>(<i>Default: OS Limit</i>)<%
        } else {
          size_t_to_size_str(num_buf, sizeof(num_buf), tmp_prob->max_file_size);
%>(<i>Default: <s:v value="num_buf" escape="false"/></i>)<%
        }
      } else if (prob->max_file_size == 0) {
%>(<i>OS Limit</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_file_size" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_open_file_count-div">
                <td>Maximum open file count:</td>
                <td><s:textfield id="orig-max_open_file_count" readonly="readonly" name="param" value="prob->max_open_file_count" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->max_open_file_count < 0) {
%>(<i>OS Limit</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_open_file_count, tmp_prob, sup_prob, global);
      if (prob->max_open_file_count < 0) {
        if (tmp_prob->max_open_file_count < 0) {
%>(<i>Default: OS Limit</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->max_open_file_count" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_open_file_count" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-max_process_count-div">
                <td>Maximum process count:</td>
                <td><s:textfield id="orig-max_process_count" readonly="readonly" name="param" value="prob->max_process_count" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->max_process_count < 0) {
%>(<i>OS Limit</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_max_process_count, tmp_prob, sup_prob, global);
      if (prob->max_process_count < 0) {
        if (tmp_prob->max_process_count < 0) {
%>(<i>Default: OS Limit</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->max_process_count" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:max_process_count" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-umask-div">
                <td>Umask value:</td>
                <td><s:textfield id="orig-umask" readonly="readonly" name="param" value="prob->umask" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupLimitsDialog(event, 'umask')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:umask" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-enable_process_group-div">
                <td>Use separate process group?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->enable_process_group == 1);
%><s:yesno id="orig-enable_process_group" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_enable_process_group, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-enable_process_group" readonly="readonly" name="param" value="prob->enable_process_group" default="tmp_prob->enable_process_group" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:enable_process_group" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_security-div">
                <td>Disable security restrictions?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_security == 1);
%><s:yesno id="orig-disable_security" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_security, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_security" readonly="readonly" name="param" value="prob->disable_security" default="tmp_prob->disable_security" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_security" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-lang_time_adj-div">
                <td>Language-specific time-limit adjustment (s):</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->lang_time_adj && prob->lang_time_adj[0]) strs = sarray_unparse(prob->lang_time_adj);
%><s:textfield id="orig-lang_time_adj" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupLimitsDialog(event, 'lang_time_adj')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:lang_time_adj" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-lang_time_adj_millis-div">
                <td>Language-specific time-limit adjustment (ms):</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->lang_time_adj_millis && prob->lang_time_adj_millis[0]) strs = sarray_unparse(prob->lang_time_adj_millis);
%><s:textfield id="orig-lang_time_adj_millis" name="param" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupLimitsDialog(event, 'lang_time_adj_millis')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:lang_time_adj_millis" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-lang_max_vm_size-div">
                <td>Language-specific memory limit:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->lang_max_vm_size && prob->lang_max_vm_size[0]) strs = sarray_unparse(prob->lang_max_vm_size);
%><s:textfield id="orig-lang_max_vm_size" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupLimitsDialog(event, 'lang_max_vm_size')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:lang_max_vm_size" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-lang_max_stack_size-div">
                <td>Language-specific stack limit:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->lang_max_stack_size && prob->lang_max_stack_size[0]) strs = sarray_unparse(prob->lang_max_stack_size);
%><s:textfield id="orig-lang_max_stack_size" name="param" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupLimitsDialog(event, 'lang_max_stack_size')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:lang_max_stack_size" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>




        </table>
    </div>

    <h3>Checker, interactor, etc</h3>

    <div>
        <table border="0" onclick="popupCheckerDialog()">
<%
  {
    const struct std_checker_info *std_checkers = super_html_std_checkers;
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-standard_checker-div">
                <td>Standard checker:</td>
                <td><s:hidden id="orig-standard_checker" name="param" value="prob->standard_checker" checkExpr="" /><%
    int j;
    for (j = 0; std_checkers[j].name; ++j) {
      if (!strcmp(prob->standard_checker, std_checkers[j].name)) {
%><s:v value="std_checkers[j].desc" /> - <%
      }
    }
%><tt><s:v value="prob->standard_checker" /></tt></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:standard_checker" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-check_cmd-div">
                <td>Checker name:</td>
                <td><%
    const unsigned char *value = prob->check_cmd;
    if (value && (!value[0] || value[0] == 1)) value = 0;
%><s:textfield id="orig-check_cmd" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_check_cmd, tmp_prob, sup_prob, global);
      if (!value) {
        if (!tmp_prob->check_cmd[0] || tmp_prob->check_cmd[0] == 1) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->check_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'check_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:check_cmd" /></td>
            </s:tr>
<%
  }
%>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-checker_real_time_limit-div">
                <td>Real time limit for checker(s):</td>
                <td><s:textfield id="orig-checker_real_time_limit" readonly="readonly" name="param" value="prob->checker_real_time_limit" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->checker_real_time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (!prob->checker_real_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_checker_real_time_limit, tmp_prob, sup_prob, global);
      if (prob->checker_real_time_limit < 0 && tmp_prob->checker_real_time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (prob->checker_real_time_limit < 0 && !tmp_prob->checker_real_time_limit) {
%>(<i>Default: Unlimited</i>)<%
      } else if (prob->checker_real_time_limit < 0) {
%>(<i>Default: <s:v value="tmp_prob->checker_real_time_limit" /></i>)<%
      } else if (!prob->checker_real_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:checker_real_time_limit" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-checker_env-div">
                <td>Checker environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->checker_env && prob->checker_env[0]) strs = sarray_unparse(prob->checker_env);
%><s:textfield id="orig-checker_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'checker_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:checker_env" /></td>
            </s:tr>
<%
  }
%>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-scoring_checker-div">
                <td>Checker calculates score?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->scoring_checker == 1);
%><s:yesno id="orig-scoring_checker" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_scoring_checker, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-scoring_checker" readonly="readonly" name="param" value="prob->scoring_checker" default="tmp_prob->scoring_checker" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:scoring_checker" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-valuer_cmd-div">
                <td>Score valuer name:</td>
                <td><%
    const unsigned char *value = prob->valuer_cmd;
    if (value && (!value[0] || value[0] == 1)) value = 0;
%><s:textfield id="orig-valuer_cmd" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_valuer_cmd, tmp_prob, sup_prob, global);
      if (!value) {
        if (!tmp_prob->valuer_cmd[0] || tmp_prob->valuer_cmd[0] == 1) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->valuer_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'valuer_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:valuer_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-valuer_sets_marked-div">
                <td>Valuer sets <i>marked</i> flag?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->valuer_sets_marked == 1);
%><s:yesno id="orig-valuer_sets_marked" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_valuer_sets_marked, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-valuer_sets_marked" readonly="readonly" name="param" value="prob->valuer_sets_marked" default="tmp_prob->valuer_sets_marked" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:valuer_sets_marked" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-interactive_valuer-div">
                <td>Valuer works interactively?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->interactive_valuer == 1);
%><s:yesno id="orig-interactive_valuer" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_interactive_valuer, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-interactive_valuer" readonly="readonly" name="param" value="prob->interactive_valuer" default="tmp_prob->interactive_valuer" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:interactive_valuer" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-valuer_env-div">
                <td>Valuer environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->valuer_env && prob->valuer_env[0]) strs = sarray_unparse(prob->valuer_env);
%><s:textfield id="orig-valuer_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'valuer_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:valuer_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-interactor_cmd-div">
                <td>Interactor name:</td>
                <td><%
    const unsigned char *value = prob->interactor_cmd;
    if (value && (!value[0] || value[0] == 1)) value = 0;
%><s:textfield id="orig-interactor_cmd" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_interactor_cmd, tmp_prob, sup_prob, global);
      if (!value) {
        if (!tmp_prob->interactor_cmd[0] || tmp_prob->interactor_cmd[0] == 1) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->interactor_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'interactor_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:interactor_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-interactor_env-div">
                <td>Interactor environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->interactor_env && prob->interactor_env[0]) strs = sarray_unparse(prob->interactor_env);
%><s:textfield id="orig-interactor_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'interactor_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:interactor_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-interactor_time_limit-div">
                <td>Time limit for interactor (s):</td>
                <td><s:textfield id="orig-interactor_time_limit" readonly="readonly" name="param" value="prob->interactor_time_limit" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0 || !sup_prob) {
      if (prob->interactor_time_limit < 0) {
%>(<i>Not set</i>)<%
      } else if (!prob->interactor_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_interactor_time_limit, tmp_prob, sup_prob, global);
      if (prob->interactor_time_limit < 0) {
        if (tmp_prob->interactor_time_limit < 0) {
%>(<i>Not set</i>)<%
        } else if (!tmp_prob->interactor_time_limit) {
%>(<i>Default: unlimited</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->interactor_time_limit" /></i>)<%
        }
      } else if (!prob->interactor_time_limit) {
%>(<i>Unlimited</i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:interactor_time_limit" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-init_cmd-div">
                <td>Init-style interactor name:</td>
                <td><%
%><s:textfield id="orig-init_cmd" readonly="readonly" name="param" value="prob->init_cmd" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!prob->init_cmd) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_init_cmd, tmp_prob, sup_prob, global);
      if (!prob->init_cmd) {
        if (!tmp_prob->init_cmd || !tmp_prob->init_cmd[0]) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->init_cmd" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'init_cmd')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:init_cmd" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-init_env-div">
                <td>Init-style interactor environment:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->init_env && prob->init_env[0]) strs = sarray_unparse(prob->init_env);
%><s:textfield id="orig-init_env" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupCheckerDialog(event, 'init_env')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:init_env" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>




        </table>
    </div>

    <h3>Scoring</h3>

    <div>
        <table border="0" onclick="popupScoringDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-ignore_compile_errors-div">
                <td>Ignore compilation errors?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->ignore_compile_errors == 1);
%><s:yesno id="orig-ignore_compile_errors" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_ignore_compile_errors, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-ignore_compile_errors" readonly="readonly" name="param" value="prob->ignore_compile_errors" default="tmp_prob->ignore_compile_errors" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:ignore_compile_errors" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-use_ac_not_ok-div">
                <td>Use PR (pending review) status instead of OK?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->use_ac_not_ok == 1);
%><s:yesno id="orig-use_ac_not_ok" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_use_ac_not_ok, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-use_ac_not_ok" readonly="readonly" name="param" value="prob->use_ac_not_ok" default="tmp_prob->use_ac_not_ok" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:use_ac_not_ok" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-ok_status-div">
                <td>Success status:</td>
                <td><s:textfield id="orig-ok_status" readonly="readonly" name="param" value="prob->ok_status" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupScoringDialog(event, 'ok_status')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:ok_status" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-ignore_prev_ac-div">
                <td>Mark previous PR as IG (ignored)?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->ignore_prev_ac == 1);
%><s:yesno id="orig-ignore_prev_ac" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_ignore_prev_ac, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-ignore_prev_ac" readonly="readonly" name="param" value="prob->ignore_prev_ac" default="tmp_prob->ignore_prev_ac" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:ignore_prev_ac" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-olympiad_mode-div">
                <td>Use Olympiad mode?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->olympiad_mode == 1);
%><s:yesno id="orig-olympiad_mode" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_olympiad_mode, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-olympiad_mode" readonly="readonly" name="param" value="prob->olympiad_mode" default="tmp_prob->olympiad_mode" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:olympiad_mode" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_latest-div">
                <td>Score the latest submit?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->score_latest == 1);
%><s:yesno id="orig-score_latest" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_score_latest, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-score_latest" readonly="readonly" name="param" value="prob->score_latest" default="tmp_prob->score_latest" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_latest" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_latest_or_unmarked-div">
                <td>Score the latest or the best unmarked?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->score_latest_or_unmarked == 1);
%><s:yesno id="orig-score_latest_or_unmarked" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_score_latest_or_unmarked, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-score_latest_or_unmarked" readonly="readonly" name="param" value="prob->score_latest_or_unmarked" default="tmp_prob->score_latest_or_unmarked" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_latest_or_unmarked" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_latest_marked-div">
                <td>Score the latest marked submit?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->score_latest_marked == 1);
%><s:yesno id="orig-score_latest_marked" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_score_latest_marked, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-score_latest_marked" readonly="readonly" name="param" value="prob->score_latest_marked" default="tmp_prob->score_latest_marked" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_latest_marked" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-ignore_unmarked-div">
                <td>Ignore unmarked runs in scoring?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->ignore_unmarked == 1);
%><s:yesno id="orig-ignore_unmarked" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_ignore_unmarked, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-ignore_unmarked" readonly="readonly" name="param" value="prob->ignore_unmarked" default="tmp_prob->ignore_unmarked" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:ignore_unmarked" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_tokenized-div">
                <td>Score only tokenized submits?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->score_tokenized == 1);
%><s:yesno id="orig-score_tokenized" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_score_tokenized, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-score_tokenized" readonly="readonly" name="param" value="prob->score_tokenized" default="tmp_prob->score_tokenized" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_tokenized" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-full_score-div">
                <td>Score for full solution:</td>
                <td><s:textfield id="orig-full_score" readonly="readonly" name="param" value="prob->full_score" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->full_score < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_full_score, tmp_prob, sup_prob, global);
      if (prob->full_score < 0) {
        if (tmp_prob->full_score < 0) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->full_score" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:full_score" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-full_user_score-div">
                <td>Score for user-visible full solution:</td>
                <td><s:textfield id="orig-full_user_score" readonly="readonly" name="param" value="prob->full_user_score" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->full_user_score < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_full_user_score, tmp_prob, sup_prob, global);
      if (prob->full_user_score < 0) {
        if (tmp_prob->full_user_score < 0) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->full_user_score" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:full_user_score" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-variable_full_score-div">
                <td>Allow variable score for full solution?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->variable_full_score == 1);
%><s:yesno id="orig-variable_full_score" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_variable_full_score, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-variable_full_score" readonly="readonly" name="param" value="prob->variable_full_score" default="tmp_prob->variable_full_score" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:variable_full_score" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_score-div">
                <td>Default score for 1 passed test:</td>
                <td><s:textfield id="orig-test_score" readonly="readonly" name="param" value="prob->test_score" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->test_score < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_test_score, tmp_prob, sup_prob, global);
      if (prob->test_score < 0) {
        if (tmp_prob->test_score < 0) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->test_score" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_score" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-run_penalty-div">
                <td>Penalty for a submission:</td>
                <td><s:textfield id="orig-run_penalty" readonly="readonly" name="param" value="prob->run_penalty" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->run_penalty < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_run_penalty, tmp_prob, sup_prob, global);
      if (prob->run_penalty < 0) {
        if (tmp_prob->run_penalty < 0) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->run_penalty" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:run_penalty" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disqualified_penalty-div">
                <td>Penalty for a disqualified submission:</td>
                <td><s:textfield id="orig-disqualified_penalty" readonly="readonly" name="param" value="prob->disqualified_penalty" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->disqualified_penalty < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_disqualified_penalty, tmp_prob, sup_prob, global);
      if (prob->disqualified_penalty < 0) {
        if (tmp_prob->disqualified_penalty < 0) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->disqualified_penalty" /></i>)<%
        }
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disqualified_penalty" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_score_list-div">
                <td>Test scores for tests:</td>
                <td><s:textfield id="orig-test_score_list-div" readonly="readonly" name="param" value="prob->test_score_list" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupScoringDialog(event, 'test_score_list')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_score_list" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-acm_run_penalty-div">
                <td>Penalty for a submission (minutes):</td>
                <td><s:textfield id="orig-acm_run_penalty" readonly="readonly" name="param" value="prob->acm_run_penalty" size="48" maxlength="1024" checkExpr=" >= 0" /><%
    if (prob_id <= 0) {
      if (prob->acm_run_penalty < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_acm_run_penalty, tmp_prob, sup_prob, global);
      if (prob->acm_run_penalty < 0 && tmp_prob->acm_run_penalty < 0) {
%>(<i>Not set</i>)<%
      } else if (prob->acm_run_penalty < 0) {
%>(<i>Default: <s:v value="tmp_prob->acm_run_penalty" /></i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:acm_run_penalty" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_tests-div">
                <td>Tests for problem scores:</td>
                <td><s:textfield id="orig-score_tests" readonly="readonly" name="param" value="prob->score_tests" size="48" maxlength="1024" check="no" /></td>
                <td><input type="button" onclick="popupScoringDialog(event, 'score_tests')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_tests" /></td>
            </s:tr>

<%
  {
    unsigned char *strs = 0;
    if (prob->test_sets && prob->test_sets[0]) strs = sarray_unparse_2(prob->test_sets);
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-test_sets-div">
                <td>Specially scored test sets:</td>
                <td><s:textfield id="orig-test_sets" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /><%
    if (!strs) {
%>(<i>Not set</i>)<%
}
%></td>
                <td><input type="button" onclick="popupScoringDialog(event, 'test_sets')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:test_sets" /></td>
            </s:tr>
<%
    xfree(strs);
  }
%>

<%
  {
    const unsigned char *value = prob->score_bonus;
    if (value && value[0] == 1) value = 0;
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_bonus-div">
                <td>Additional score bonus:</td>
                <td><s:textfield id="orig-score_bonus" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0) {
      if (!value) {
%>(<i>Not set</i>)<%
      } else if (!*value) {
%>(<i>Empty</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_score_bonus, tmp_prob, sup_prob, global);
      if (!value) {
        if (!tmp_prob->score_bonus[0] || tmp_prob->score_bonus[0] == 1) {
%>(<i>Not set</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->score_bonus" /></i>)<%
        }
      } else if (!*value) {
%>(<i>Empty</i>)<%
      }
    }
%></td>
                <td><input type="button" onclick="popupScoringDialog(event, 'score_bonus')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_bonus" /></td>
            </s:tr>
<%
  }
%>




        </table>
    </div>

    <h3>Feedback</h3>

    <div>
        <table border="0" onclick="popupFeedbackDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-team_enable_rep_view-div">
                <td>Contestant may view testing protocol?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->team_enable_rep_view == 1);
%><s:yesno id="orig-team_enable_rep_view" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_team_enable_rep_view, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-team_enable_rep_view" readonly="readonly" name="param" value="prob->team_enable_rep_view" default="tmp_prob->team_enable_rep_view" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:team_enable_rep_view" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-team_enable_ce_view-div">
                <td>Contestant may view compilation errors?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->team_enable_ce_view == 1);
%><s:yesno id="orig-team_enable_ce_view" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_team_enable_ce_view, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-team_enable_ce_view" readonly="readonly" name="param" value="prob->team_enable_ce_view" default="tmp_prob->team_enable_ce_view" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:team_enable_ce_view" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-team_show_judge_report-div">
                <td>Contestant may view FULL testing protocol?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->team_show_judge_report == 1);
%><s:yesno id="orig-team_show_judge_report" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_team_show_judge_report, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-team_show_judge_report" readonly="readonly" name="param" value="prob->team_show_judge_report" default="tmp_prob->team_show_judge_report" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:team_show_judge_report" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-show_checker_comment-div">
                <td>Contestant may view checker comment?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->show_checker_comment == 1);
%><s:yesno id="orig-show_checker_comment" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_show_checker_comment, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-show_checker_comment" readonly="readonly" name="param" value="prob->show_checker_comment" default="tmp_prob->show_checker_comment" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:show_checker_comment" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-open_tests-div">
                <td>Tests open for participants:</td>
                <td><s:textfield id="orig-open_tests" readonly="readonly" name="param" value="prob->open_tests" size="48" maxlength="1024" check="no" /></td>
                <td><input type="button" onclick="popupFeedbackDialog(event, 'open_tests')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:open_tests" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-final_open_tests-div">
                <td>Tests open for participants finally:</td>
                <td><s:textfield id="orig-final_open_tests" readonly="readonly" name="param" value="prob->final_open_tests" size="48" maxlength="1024" check="no" /></td>
                <td><input type="button" onclick="popupFeedbackDialog(event, 'final_open_tests')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:final_open_tests" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-enable_tokens-div">
                <td>Enable tokens?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->enable_tokens == 1;
%><s:yesno id="orig-enable_tokens" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_enable_tokens, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-enable_tokens" readonly="readonly" name="param" value="prob->enable_tokens" default="tmp_prob->enable_tokens" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:enable_tokens" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tokens_for_user_ac-div">
                <td>Tokens only for user AC submits?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = prob->tokens_for_user_ac == 1;
%><s:yesno id="orig-tokens_for_user_ac" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_tokens_for_user_ac, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-tokens_for_user_ac" readonly="readonly" name="param" value="prob->tokens_for_user_ac" default="tmp_prob->tokens_for_user_ac" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tokens_for_user_ac" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tokens-div">
                <td>Token specification:</td>
                <td><s:textfield id="orig-tokens" readonly="readonly" name="param" value="prob->tokens" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupFeedbackDialog(event, 'tokens')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="serve.cfg:problem:tokens" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-token_open_tests-div">
                <td>Tests open for tokens:</td>
                <td><s:textfield id="orig-token_open_tests" readonly="readonly" name="param" value="prob->token_open_tests" size="48" maxlength="1024" check="" /></td>
                <td><input type="button" onclick="popupFeedbackDialog(event, 'token_open_tests')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="serve.cfg:problem:token_open_tests" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-tests_to_accept-div">
                <td>Number of accept tests:</td>
                <td><s:textfield id="orig-tests_to_accept" readonly="readonly" name="param" value="prob->tests_to_accept" size="48" maxlength="1024" checkExpr=">= 0" /><%
    if (prob_id <= 0) {
      if (prob->tests_to_accept < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_tests_to_accept, tmp_prob, sup_prob, global);
      if (prob->tests_to_accept < 0 && tmp_prob->tests_to_accept < 0) {
%>(<i>Not set</i>)<%
      } else {
%>(<i>Default: <s:v value="tmp_prob->tests_to_accept" /></i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:tests_to_accept" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-accept_partial-div">
                <td>Accept for testing solutions that do not pass all accept tests?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->accept_partial == 1);
%><s:yesno id="orig-accept_partial" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_accept_partial, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-accept_partial" readonly="readonly" name="param" value="prob->accept_partial" default="tmp_prob->accept_partial" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:accept_partial" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-min_tests_to_accept-div">
                <td>Min. number of accept tests:</td>
                <td><s:textfield id="orig-min_tests_to_accept" readonly="readonly" name="param" value="prob->min_tests_to_accept" size="48" maxlength="1024" checkExpr=">= 0" /><%
    if (prob_id <= 0) {
      if (prob->min_tests_to_accept < 0) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_min_tests_to_accept, tmp_prob, sup_prob, global);
      if (prob->min_tests_to_accept < 0 && tmp_prob->min_tests_to_accept < 0) {
%>(<i>Not set</i>)<%
      } else {
%>(<i>Default: <s:v value="tmp_prob->min_tests_to_accept" /></i>)<%
      }
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:min_tests_to_accept" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_pe-div">
                <td>Report Presentation Error as Wrong Answer?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_pe == 1);
%><s:yesno id="orig-disable_pe" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_pe, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_pe" readonly="readonly" name="param" value="prob->disable_pe" default="tmp_prob->disable_pe" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_pe" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-disable_wtl-div">
                <td>Report Wall Time Limit Exceeded as Time Limit Exceeded?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->disable_wtl == 1);
%><s:yesno id="orig-disable_wtl" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_disable_wtl, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-disable_wtl" readonly="readonly" name="param" value="prob->disable_wtl" default="tmp_prob->disable_wtl" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:disable_wtl" /></td>
            </s:tr>



        </table>
    </div>


    <h3>Standings</h3>

    <div>
        <table border="0" onclick="popupStandingsDialog()">
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_name-div">
                <td>Title for the standings column:</td>
                <td><s:textfield id="orig-stand_name" readonly="readonly" name="param" value="prob->stand_name" size="48" maxlength="1024" check="no" /><% if (!prob->stand_name) { %>(<i>Not set</i>)<% } %></td>
                <td><input type="button" onclick="popupStandingsDialog(event, 'stand_name')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_name" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_column-div">
                <td>Collate this problem with the specified one:</td>
                <td><s:textfield id="orig-stand_column" readonly="readonly" name="param" value="prob->stand_column" size="48" maxlength="1024" check="no" /><% if (!prob->stand_column) { %>(<i>Not set</i>)<% } %></td>
                <td><input type="button" onclick="popupStandingsDialog(event, 'stand_column')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_column" /></td>
            </s:tr>

            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-hidden-div">
                <td>Do not show this problem in standings?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->hidden == 1);
%><s:yesno id="orig-hidden" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_hidden, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-hidden" readonly="readonly" name="param" value="prob->hidden" default="tmp_prob->hidden" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:hidden" /></td>
            </s:tr>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_hide_time-div">
                <td>Do not show accept time for this problem?</td>
                <td><%
    int value = (prob->stand_hide_time > 0);
%><s:yesno id="orig-stand_hide_time" readonly="readonly" name="param" value="value" /></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_hide_time" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_attr-div">
                <td>Standings attributes:</td>
                <td><%
    const unsigned char *value = prob->stand_attr;
    if (value && (!value[0] || value[0] == 1)) value = 0;
%><s:textfield id="orig-stand_attr" readonly="readonly" name="param" value="value" size="48" maxlength="1024" checkExpr="" /><%
    if (prob_id <= 0 || !sup_prob) {
      if (!value) {
%>(<i>Not set</i>)<%
      }
    } else {
      prepare_set_prob_value(CNTSPROB_stand_attr, tmp_prob, sup_prob, global);
      if (!value) {
        if (tmp_prob->stand_attr[0] == 1) {
%>(<i>Not set</i>)<%
        } else if (!tmp_prob->stand_attr[0]) {
%>(<i>Default: empty</i>)<%
        } else {
%>(<i>Default: <s:v value="tmp_prob->stand_attr" /></i>)<%
        }
      }
    }
%></td>
                <td><input type="button" onclick="popupStandingsDialog(event, 'stand_attr')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_attr" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-score_view-div">
                <td>Special view for scores:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->score_view && prob->score_view[0]) strs = sarray_unparse(prob->score_view);
%><s:textfield id="orig-score_view" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupStandingsDialog(event, 'score_view')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:score_view" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_ignore_score-div">
                <td>Ignore problem score in standings?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->stand_ignore_score == 1);
%><s:yesno id="orig-stand_ignore_score" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_stand_ignore_score, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-stand_ignore_score" readonly="readonly" name="param" value="prob->stand_ignore_score" default="tmp_prob->stand_ignore_score" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_ignore_score" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-stand_last_column-div">
                <td>Show the problem after all results?</td>
                <td><%
    if (prob_id <= 0 || !sup_prob) {
      int value = (prob->stand_last_column == 1);
%><s:yesno id="orig-stand_last_column" readonly="readonly" name="param" value="value" /><%
    } else {
      prepare_set_prob_value(CNTSPROB_stand_last_column, tmp_prob, sup_prob, global);
%><s:yesno3 id="orig-stand_last_column" readonly="readonly" name="param" value="prob->stand_last_column" default="tmp_prob->stand_last_column" /><%
    }
%></td>
                <td>&nbsp;</td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:stand_last_column" /></td>
            </s:tr>
<%
  }
%>

<%
  {
%>
            <s:tr attr="form_row_attrs[row ^= 1]" id="orig-provide_ok-div">
                <td>Provide OK to problems:</td>
                <td><%
    unsigned char *strs = 0;
    if (prob->provide_ok && prob->provide_ok[0]) strs = sarray_unparse(prob->provide_ok);
%><s:textfield id="orig-provide_ok" readonly="readonly" name="param" value="strs" size="48" maxlength="1024" checkExpr="" /></td>
                <td><input type="button" onclick="popupStandingsDialog(event, 'provide_ok')" value="Clear" /></td>
                <td onclick="np(event);"><s:help topic="Serve.cfg:problem:provide_ok" /></td>
            </s:tr>
<%
    xfree(strs); strs = 0;
  }
%>


        </table>
    </div>


<%
  if (prob->unhandled_vars) {
%>
    <h3>Uneditable parameters</h3>

    <div>
        <table border="0">
            <s:tr attr="form_row_attrs[row ^= 1]">
                <td colspan="4"><pre><s:v value="prob->unhandled_vars" /></pre></td>
            </s:tr>
        </table>
    </div>
<%
  }
%>

</div>

<%
bottom_links: ;
%>

<%@include "cnts_edit_cur_bottom_menu.csp"
%>

<%@include "footer.csp"
%><%
cleanup:
  tmp_prob = prepare_problem_free(tmp_prob);
  l10n_resetlocale();
  html_armor_free(&ab);
%>
